<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ - bulk-print-js</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            line-height: 1.6;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .print-page { 
            border: 1px solid #ddd; 
            margin: 10px 0; 
            padding: 20px; 
            page-break-after: always;
            background: white;
        }
        button { 
            padding: 12px 24px; 
            background: #007bff; 
            color: white; 
            border: none; 
            cursor: pointer; 
            margin: 10px 5px;
            border-radius: 4px;
            font-size: 14px;
        }
        button:hover { background: #0056b3; }
        .progress { 
            margin: 20px 0; 
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        .demo-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        @media print {
            body { margin: 0; }
            .demo-section, button, .progress { display: none; }
            .print-page { border: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“¦ bulk-print-js åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h1>
        
        <div class="demo-section">
            <h3>å¿«é€Ÿæµ‹è¯•</h3>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒçš„æ‰“å°æ¨¡å¼ï¼š</p>
            <button onclick="startBasicPrint()">ğŸš€ åŸºç¡€æ‰“å° (è‡ªåŠ¨æ¨¡å¼)</button>
            <button onclick="startManualPrint()">ğŸ‘† æ‰‹åŠ¨ç¡®è®¤æ‰“å°</button>
            <button onclick="startLargePrint()">ğŸ“Š å¤§æ‰¹é‡æ‰“å° (50é¡µ)</button>
        </div>
        
        <div class="progress" id="progress">
            <strong>çŠ¶æ€ï¼š</strong>ç­‰å¾…å¼€å§‹æ‰“å°...
        </div>
        
        <div id="print-container" style="display: none;">
            <!-- ç”Ÿæˆ10ä¸ªæµ‹è¯•é¡µé¢ -->
            <div class="print-page">
                <h2>ğŸ“„ ç¬¬ 1 é¡µ</h2>
                <p>è¿™æ˜¯ç¬¬ä¸€é¡µçš„æµ‹è¯•å†…å®¹ï¼Œç”¨äºæ¼”ç¤ºæ‰¹é‡æ‰“å°åŠŸèƒ½ã€‚</p>
                <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="time1"></span></p>
                <div style="background: #e9ecef; padding: 10px; margin: 10px 0;">
                    <p>è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹å†…å®¹å—ï¼Œå±•ç¤ºäº†æ‰“å°é¡µé¢çš„åŸºæœ¬å¸ƒå±€ã€‚</p>
                </div>
            </div>
            <div class="print-page">
                <h2>ğŸ“„ ç¬¬ 2 é¡µ</h2>
                <p>è¿™æ˜¯ç¬¬äºŒé¡µçš„æµ‹è¯•å†…å®¹ï¼ŒåŒ…å«ä¸åŒçš„æ•°æ®å±•ç¤ºã€‚</p>
                <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="time2"></span></p>
                <table style="width: 100%; border-collapse: collapse;">
                    <tr><td style="border: 1px solid #ddd; padding: 8px;">é¡¹ç›® A</td><td style="border: 1px solid #ddd; padding: 8px;">100</td></tr>
                    <tr><td style="border: 1px solid #ddd; padding: 8px;">é¡¹ç›® B</td><td style="border: 1px solid #ddd; padding: 8px;">200</td></tr>
                </table>
            </div>
            <div class="print-page">
                <h2>ğŸ“„ ç¬¬ 3 é¡µ</h2>
                <p>è¿™æ˜¯ç¬¬ä¸‰é¡µï¼Œå±•ç¤ºåˆ—è¡¨å†…å®¹ã€‚</p>
                <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="time3"></span></p>
                <ul>
                    <li>åˆ—è¡¨é¡¹ç›® 1 - æµ‹è¯•æ•°æ®</li>
                    <li>åˆ—è¡¨é¡¹ç›® 2 - æ›´å¤šå†…å®¹</li>
                    <li>åˆ—è¡¨é¡¹ç›® 3 - ç¤ºä¾‹æ–‡æœ¬</li>
                </ul>
            </div>
            <div class="print-page">
                <h2>ğŸ“„ ç¬¬ 4 é¡µ</h2>
                <p>è¿™æ˜¯ç¬¬å››é¡µï¼ŒåŒ…å«å›¾è¡¨å ä½ç¬¦ã€‚</p>
                <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="time4"></span></p>
                <div style="height: 200px; background: linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0), linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0); background-size: 20px 20px; background-position: 0 0, 10px 10px; display: flex; align-items: center; justify-content: center; color: #666;">
                    ğŸ“Š å›¾è¡¨åŒºåŸŸ (ç¤ºä¾‹)
                </div>
            </div>
            <div class="print-page">
                <h2>ğŸ“„ ç¬¬ 5 é¡µ</h2>
                <p>è¿™æ˜¯ç¬¬äº”é¡µï¼ŒåŒ…å«å¼•ç”¨æ–‡æœ¬ã€‚</p>
                <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong><span id="time5"></span></p>
                <blockquote style="border-left: 4px solid #007bff; padding-left: 20px; margin: 20px 0; font-style: italic;">
                    "bulk-print-js è®©å¤§æ‰¹é‡æ‰“å°å˜å¾—ç®€å•é«˜æ•ˆï¼Œè§£å†³äº†å†…å­˜æº¢å‡ºå’Œæ€§èƒ½é—®é¢˜ã€‚"
                </blockquote>
            </div>
        </div>
    </div>

    <script src="../dist/bulk-print.umd.js"></script>
    <script>
        // æ›´æ–°æ—¶é—´æˆ³
        function updateTimestamps() {
            for(let i = 1; i <= 5; i++) {
                const timeSpan = document.getElementById(`time${i}`);
                if(timeSpan) {
                    timeSpan.textContent = new Date().toLocaleString('zh-CN');
                }
            }
        }

        function updateProgress(message, type = 'info') {
            const progressEl = document.getElementById('progress');
            const icons = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸'
            };
            progressEl.innerHTML = `<strong>${icons[type]} çŠ¶æ€ï¼š</strong>${message}`;
        }

        async function startBasicPrint() {
            updateProgress('å¼€å§‹åŸºç¡€æ‰“å°ï¼ˆè‡ªåŠ¨æ¨¡å¼ï¼‰...', 'info');
            updateTimestamps();
            
            try {
                const printer = new BulkPrint({
                    batchSize: 2,
                    autoMode: true,
                    delayBetweenBatches: 500
                });

                printer.on('progress', (data) => {
                    updateProgress(`æ‰“å°è¿›åº¦: ${data.progress}% (${data.printedPages}/${data.totalPages} é¡µ)`, 'info');
                });

                printer.on('finish', (data) => {
                    updateProgress(`ğŸ‰ æ‰“å°å®Œæˆ! å…±æ‰“å° ${data.printedPages} é¡µ`, 'success');
                });

                await printer.print({
                    printElement: document.getElementById('print-container'),
                    totalPages: 5,
                    directPrintCallback: () => {
                        // ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°é€»è¾‘
                        console.log('æ‰§è¡Œè‡ªå®šä¹‰æ‰“å°');
                        window.print();
                    }
                });
            } catch (error) {
                updateProgress(`âŒ æ‰“å°å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function startManualPrint() {
            updateProgress('å¼€å§‹æ‰‹åŠ¨ç¡®è®¤æ‰“å°...', 'info');
            updateTimestamps();
            
            try {
                const printer = new BulkPrint({
                    batchSize: 1,
                    autoMode: false,
                    delayBetweenBatches: 1000,
                    confirmEachBatch: true
                });

                printer.on('batchStart', (data) => {
                    updateProgress(`ğŸ”„ å¼€å§‹ç¬¬ ${data.batch} æ‰¹æ‰“å°ï¼Œè¯·ç¡®è®¤æ‰“å°å¯¹è¯æ¡†`, 'warning');
                });

                printer.on('progress', (data) => {
                    updateProgress(`ğŸ“Š è¿›åº¦: ${data.progress}% (${data.printedPages}/${data.totalPages} é¡µ)`, 'info');
                });

                printer.on('finish', (data) => {
                    updateProgress(`ğŸ‰ å…¨éƒ¨å®Œæˆ! å…±æ‰“å° ${data.printedPages} é¡µ`, 'success');
                });

                await printer.print({
                    printElement: document.getElementById('print-container'),
                    totalPages: 5,
                    directPrintCallback: () => {
                        // ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°é€»è¾‘
                        console.log('æ‰§è¡Œè‡ªå®šä¹‰æ‰“å°');
                        window.print();
                    }
                });
            } catch (error) {
                updateProgress(`âŒ æ‰“å°å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function startLargePrint() {
            // ç”Ÿæˆæ›´å¤šé¡µé¢ç”¨äºå¤§æ‰¹é‡æµ‹è¯•
            const container = document.getElementById('print-container');
            const currentPages = container.children.length;
            
            if (currentPages < 50) {
                for (let i = currentPages + 1; i <= 50; i++) {
                    const page = document.createElement('div');
                    page.className = 'print-page';
                    page.innerHTML = `
                        <h2>ğŸ“„ ç¬¬ ${i} é¡µ</h2>
                        <p>è¿™æ˜¯ç¬¬ ${i} é¡µçš„å¤§æ‰¹é‡æµ‹è¯•å†…å®¹ã€‚</p>
                        <p><strong>é¡µé¢ç¼–å·ï¼š</strong>${i} / 50</p>
                        <p><strong>ç”Ÿæˆæ—¶é—´ï¼š</strong>${new Date().toLocaleString('zh-CN')}</p>
                        <div style="padding: 20px; background: #f8f9fa; margin: 10px 0;">
                            <p>è¿™æ˜¯å¤§æ‰¹é‡æ‰“å°æµ‹è¯•çš„ç¬¬ ${i} é¡µå†…å®¹ã€‚</p>
                            <p>ç”¨äºéªŒè¯å†…å­˜ä¼˜åŒ–å’Œåˆ†æ‰¹å¤„ç†åŠŸèƒ½ã€‚</p>
                        </div>
                    `;
                    container.appendChild(page);
                }
            }

            updateProgress('å¼€å§‹å¤§æ‰¹é‡æ‰“å°æµ‹è¯•ï¼ˆ50é¡µï¼‰...', 'info');
            
            try {
                const printer = new BulkPrint({
                    batchSize: 10,
                    autoMode: true,
                    delayBetweenBatches: 800
                });

                printer.on('batchStart', (data) => {
                    updateProgress(`ğŸ“¦ å¼€å§‹ç¬¬ ${data.batch}/${data.totalBatches} æ‰¹ï¼Œå¤„ç† ${data.pagesInBatch} é¡µ`, 'info');
                });

                printer.on('progress', (data) => {
                    updateProgress(`ğŸ“Š æ€»è¿›åº¦: ${data.progress}% (${data.printedPages}/50 é¡µ)`, 'info');
                });

                printer.on('finish', (data) => {
                    updateProgress(`ğŸ‰ å¤§æ‰¹é‡æ‰“å°å®Œæˆ! å…±æ‰“å° ${data.printedPages} é¡µ`, 'success');
                });

                await printer.print({
                    printElement: container,
                    totalPages: 50,
                    batchThreshold: 20,
                    directPrintCallback: () => {
                        // ç”¨æˆ·è‡ªå®šä¹‰çš„æ‰“å°é€»è¾‘
                        console.log('æ‰§è¡Œè‡ªå®šä¹‰æ‰“å°');
                        window.print();
                    }
                });
            } catch (error) {
                updateProgress(`âŒ å¤§æ‰¹é‡æ‰“å°å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ›´æ–°æ—¶é—´æˆ³
        document.addEventListener('DOMContentLoaded', updateTimestamps);
    </script>
</body>
</html>